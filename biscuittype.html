<!DOCTYPE html>
<html lang="fr">
	<link rel="stylesheet" href="./css/stylecva.css">
	<body>
		<div class="container_header">
			<a href="index.html">
				<div class="container_item">
					<img src="../image/home.png" alt="title">
				</div>
			</a>
			<a href="index.html">
				<div class="container_item">
					<img src="../image/title.png" alt="home" width="auto" height="75px">
				</div>
			</a>
			<div class="container_item">
				<form action="javascript:void(0);" onsubmit="onHandleSearch()">
					<input type="search" id="search-bar" placeholder="Rechercher..." />
					<input type="submit" value="ok" />
				</form>
			</div>
			<div class="container_item">
				<img src="../image/filtre.png" alt="filtre">
			</div><br>
		</div><br><br><br>
		
		<h1 id="title"></h1>
		<div class="container_image">
			<img id="biscuit_img"/>
			<p><U>Ingrédients:</U></p>
			<ul id="liste_ingredients"></ul>
			<p><U>allergènes:</U></p>
			<ul id="liste_allergenes"></ul>
			</div>
		</div>
		<div class="container_down">
			<a href="./napolitain.html"><img src="./image/left-arrow - Copie.png"alt="home"></a>
			<a href="./snickers.html"><img src="./image/right-arrow.png"alt="home"></a> 
		</div>

		<script>
			console.log("hello!");
			function search() {
				console.log("search !");
			}
            var searchParams = new URLSearchParams(window.location.search); //?anything=123
			const id = searchParams.get("id");
			const url= `https://world.openfoodfacts.org/api/v3/product/${id}.json`;
			fetch(url).then(function (response)
			{
				return(response.json());

			}).then(function (response){
				console.log(response);
                // title
                const name= document.querySelector("#title");
				name.innerHTML= (response.product.product_name)

				// image
				const image_url = response.product.image_front_url;
				const img= document.querySelector("#biscuit_img");
				img.setAttribute("src", image_url);

				// ingredients
				const listIngredients= document.querySelector("#liste_ingredients");
				listIngredients.innerHTML= (response.product.ingredients).map(function(ingredient)
				{
					return `<li>${ingredient.text.replaceAll("_"," ")}</li>`;
				}).join("")
				// allergènes
				const listAllergenes= document.querySelector("#liste_allergenes");
				listAllergenes.innerHTML= (response.product.allergens_tags).map(function(allergen)
				{
					return `<li>${allergen.replaceAll("en:"," ")}</li>`;
				}).join("")

			});

		</script>
		
	</body>
</html>